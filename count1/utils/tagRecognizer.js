/**
 * 标签识别工具
 * 用于根据账单备注自动识别对应的标签类别
 */

// 标签关键词映射表
const tagKeywords = {
  // 餐饮类关键词
  '餐饮': [
    '饭', '餐', '食', '吃', '喝', '菜', '饮',
    '早餐', '午餐', '晚餐', '夜宵',
    '零食', '水果', '外卖', '堂食',
    '火锅', '烧烤'
  ],
  
  // 交通类关键词
  '交通': [
    '车', '地铁', '公交', '打车', 'taxi', '出租',
    '高铁', '动车', '火车', '飞机', '机票',
    '船', '轮渡', '公里', '油费', '加油'
  ],
  
  // 购物类关键词
  '购物': [
    '买', '购', '衣', '裤', '鞋', '包',
    '超市', '商场', '淘宝', '京东',
    '电商', '网购', '商品'
  ],
  
  // 娱乐类关键词
  '娱乐': [
    '玩', '游戏', '电影', '电视', '视频',
    '唱歌', 'KTV', '酒吧',
    '旅游', '景点', '门票', '娱乐'
  ],
  
  // 居住类关键词
  '居住': [
    '房', '租', '水费', '电费', '气费',
    '物业', '宽带', '网费',
    '装修', '家具', '家电'
  ],
  
  // 医疗类关键词
  '医疗': [
    '医', '药', '病', '诊', '治',
    '保健', '手术', '住院', '门诊', '挂号'
  ],
  
  // 教育类关键词
  '教育': [
    '学', '教', '培训', '课', '书',
    '文具', '笔', '本', '考试', '报名费'
  ],
  
  // 其他类（无关键词，作为默认分类）
  '其他': []
};

/**
 * 识别标签函数
 * @param {string} note - 账单备注文本
 * @returns {string} - 识别出的标签名称
 */
function recognizeTag(note) {
  // 如果没有备注，返回默认标签
  if (!note) return '其他';
  
  // 转换为小写以便匹配
  const lowerNote = note.toLowerCase();
  
  // 遍历所有标签的关键词
  for (const [tag, keywords] of Object.entries(tagKeywords)) {
    // 如果任何一个关键词匹配，返回对应的标签
    if (keywords.some(keyword => lowerNote.includes(keyword))) {
      return tag;
    }
  }
  
  // 如果没有匹配到任何标签，返回"其他"
  return '其他';
}

// 导出函数
module.exports = {
  recognizeTag
}; 